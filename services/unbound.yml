services:
  unbound:
    image: mvance/unbound:latest
    container_name: unbound
    # Expose DNS to the LAN host
    # Ports not published as unbound is running internal-only
    ports:
      - "66:53/udp"   # DNS over UDP
      - "66:53/tcp"   # TCP fallback / large replies
    # Configs are read-only (:ro)
    volumes:
      # - ${BASE}/configs/unbound/unbound.conf:/opt/unbound/etc/unbound/unbound.conf:ro   # your unbound.conf, local records, etc.
      - ../configs/unbound/unbound.conf:/opt/unbound/etc/unbound/unbound.conf:ro
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "drill", "@127.0.0.1", "cloudflare.com", "A"]
      interval: 30s
      timeout: 5s
      retries: 5
      start_period: 20s
